filename: "vmm32/vkd.vxd"
#TODO: bring up more details from symdeb
binary: "vmm32/vkd.vxd"
description: ""
note: ""
appearances:
  - version: "system"
    tree: []
    segments:
      - num: "1"
        name: "_LGROUP"
        offset: "00002660"
        symbols:
          - name: 'VKD_Control'
            offset: "00000000"            
          - name: 'VKD_Get_Shift_State'
            offset: "00000068"            
          - name: 'VKD_Set_Shift_State'
            offset: "00000082"            
          - name: 'VKD_Begin_Msg_Mode'
            offset: "000000B7"            
          - name: 'VKD_End_Msg_Mode'
            offset: "000000FB"            
          - name: 'VKD_Power_Handler'
            offset: "00000129"            
          - name: 'VKD_Force_Keys'
            offset: "00000155"            
          - name: 'VKD_Get_Kbd_Owner'
            offset: "000001AC"            
          - name: 'VKD_Get_Msg_Key'
            offset: "000001C1"            
          - name: 'VKD_Peek_Msg_Key'
            offset: "0000020B"            
          - name: 'VKD_Flush_Msg_Key_Queue'
            offset: "00000250"            
          - name: 'VKD_VM_Service_Phys'
            offset: "0000028C"            
          - name: 'VKD_VM_Server'
            offset: "00000294"            
          - name: 'VKD_Beep'
            offset: "00000323"            
          - name: 'VKD_VM_Server_Part_2'
            offset: "00000335"            
          - name: 'VKD_Pause_Block'
            offset: "000003FB"            
          - name: 'VKD_Get_Key'
            offset: "00000418"            
          - name: 'Build_Key'
            offset: "00000476"            
          - name: 'Simulate_VM_INT9'
            offset: "000004D0"            
          - name: 'Queue_Output'
            offset: "000005D4"            
          - name: 'Queue_Ext_Shift'
            offset: "000005F0"            
          - name: 'Queue_Virtual_Key'
            offset: "000006E6"            
          - name: 'Queue_Msg_Mode_Key'
            offset: "00000747"            
          - name: 'VKD_send_ralt_pre'
            offset: "000007B1"            
          - name: 'Update_Shift_State'
            offset: "000007C8"            
          - name: 'VKD_EOI'
            offset: "000008F4"            
          - name: 'VKD_Virt_Int'
            offset: "0000093F"            
          - name: 'VKD_IRET'
            offset: "0000095C"            
          - name: 'VKD_Next_Paste_Code'
            offset: "000009B5"            
          - name: 'VKD_Release_TS_Hook'
            offset: "000009CB"            
          - name: 'Chk_Win_Key_State'
            offset: "00000A24"            
          - name: 'IsShiftKey'
            offset: "00000A5F"            
          - name: 'IsModifierKey'
            offset: "00000A6B"            
          - name: 'VKD_Chk_BIOS_Toggle_State'
            offset: "00000A92"            
          - name: 'VKD_Convert_BIOS_Shift_State'
            offset: "00000ABE"            
          - name: 'CombineShiftKeys'
            offset: "00000B08"            
          - name: 'Chk_Shift_State'
            offset: "00000B26"            
          - name: 'Show_VMs_VKD_State'
            offset: "00000BBE"            
          - name: 'Show_VKD_Hot_Key'
            offset: "00000C80"            
          - name: 'VKD_Debug_Query'
            offset: "00000D34"            
          - name: 'VKD_Queue_Info'
            offset: "00000DCD"            
          - name: 'VKD_HtKy_Info'
            offset: "00000E56"            
          - name: 'VKD_VM_Info'
            offset: "00000EAE"            
          - name: 'VKD_Gen_Info'
            offset: "00000F4B"            
          - name: 'Chk_Hot_Keys'
            offset: "00000FE8"            
          - name: 'VKD_Trap_CommandR'
            offset: "00001100"            
          - name: 'VKD_Trap_DataR'
            offset: "00001268"            
          - name: '_8042_Buf_Empty'
            offset: "00001421"            
          - name: 'Get_8042_Byte'
            offset: "0000142A"            
          - name: 'Put_8042_Byte'
            offset: "00001440"            
          - name: 'VKD_8042_Response'
            offset: "00001454"            
          - name: 'VKD_8042_Server'
            offset: "00001470"            
          - name: 'VKD_OutputByte'
            offset: "00001496"            
          - name: 'VKD_send_queued_command'
            offset: "000014A1"            
          - name: 'VKD_Filter_Keyboard_Input'
            offset: "000014C4"            
          - name: 'VKD_Int_09'
            offset: "000014D0"            
          - name: 'Kybd_Wait_Out'
            offset: "000015F5"            
          - name: 'VKD_Send_Data'
            offset: "00001638"            
          - name: 'VKD_Send_Cmd'
            offset: "0000166A"            
          - name: 'VKD_Buf_Empty'
            offset: "00001672"            
          - name: 'VKD_Get_Byte'
            offset: "00001680"            
          - name: 'VKD_Put_Byte'
            offset: "000016AB"            
          - name: 'VKD_Clear_Data_Buf'
            offset: "000016DD"            
          - name: 'VKD_Poll_ACK'
            offset: "000016EA"            
          - name: 'VKD_Set_LEDs'
            offset: "0000171C"            
          - name: 'VKD_Set_Key_Rate'
            offset: "0000176C"            
          - name: 'VKD_Get_Key_Rate'
            offset: "000017BC"            
          - name: 'VKD_ACK_Timeout'
            offset: "000017CA"            
          - name: 'VKD_Reboot'
            offset: "000017F8"            
          - name: 'Dump_KeyBuf'
            offset: "0000180B"            
          - name: 'VAD_Read_Command'
            offset: "00001880"            
          - name: 'VAD_Write_Command'
            offset: "000018C8"            
          - name: 'VAD_Read_Data'
            offset: "000018DC"            
          - name: '_VKD_Get_Version'
            offset: "00001944"            
          - name: '_VKD_Define_Hot_Key'
            offset: "00001948"            
          - name: '_VKD_Remove_Hot_Key'
            offset: "0000194C"            
          - name: '_VKD_Local_Enable_Hot_Key'
            offset: "00001950"            
          - name: '_VKD_Local_Disable_Hot_Key'
            offset: "00001954"            
          - name: '_VKD_Reflect_Hot_Key'
            offset: "00001958"            
          - name: '_VKD_Cancel_Hot_Key_State'
            offset: "0000195C"            
          - name: '_VKD_Force_Keys'
            offset: "00001960"            
          - name: '_VKD_Get_Kbd_Owner'
            offset: "00001964"            
          - name: '_VKD_Define_Paste_Mode'
            offset: "00001968"            
          - name: '_VKD_Start_Paste'
            offset: "0000196C"            
          - name: '_VKD_Cancel_Paste'
            offset: "00001970"            
          - name: '_VKD_Get_Msg_Key'
            offset: "00001974"            
          - name: '_VKD_Peek_Msg_Key'
            offset: "00001978"            
          - name: '_VKD_Flush_Msg_Key_Queue'
            offset: "0000197C"            
          - name: '_VKD_Enable_Keyboard'
            offset: "00001980"            
          - name: '_VKD_Disable_Keyboard'
            offset: "00001984"            
          - name: '_VKD_Get_Shift_State'
            offset: "00001988"            
          - name: '_VKD_Filter_Keyboard_Input'
            offset: "0000198C"            
          - name: '_VKD_Put_Byte'
            offset: "00001990"            
          - name: '_VKD_Set_Shift_State'
            offset: "00001994"            
          - name: '_VKD_Send_Data'
            offset: "00001998"            
          - name: '_VKD_Set_LEDs'
            offset: "0000199C"            
          - name: '_VKD_Set_Key_Rate'
            offset: "000019A0"            
          - name: '_VKD_Get_Key_Rate'
            offset: "000019A4"            
          - name: 'VKD_DDB'
            offset: "000019A8"            
          - name: 'VKD_irq_Handle'
            offset: "000019F8"            
          - name: 'VKD_CB_Offset'
            offset: "000019FC"            
          - name: 'VKD_Kbd_Owner'
            offset: "00001A00"            
          - name: 'NewShell'
            offset: "00001A0C"            
          - name: 'VK_D_QFlag'
            offset: "00001A0D"            
          - name: 'VKD_Int_Boost_Amount'
            offset: "00001A10"            
          - name: 'VKD_gbl_shift_state'
            offset: "00001A19"            
          - name: 'VKD_flags'
            offset: "00001A3D"            
          - name: 'VKD_attempt_reboot'
            offset: "00001A46"            
          - name: 'Hot_Key_List'
            offset: "00001F60"            
          - name: 'Hot_Key_Notify_List'
            offset: "00001F64"            
          - name: 'VKD_8042_owner'
            offset: "00002124"            
          - name: 'VKD_8042_cmd_table'
            offset: "00002128"            
          - name: 'VKD_Last_LED'
            offset: "000022D8"            
          - name: 'VKD_Last_Key_Rate'
            offset: "000022D9"            
          - name: 'VAD_Exists'
            offset: "0000246D"            
      - num: "2"
        name: "_IMGROUP"
        offset: "000026A0"
        symbols:
          - name: '@MSG_IAB'
            offset: "00000000"            
          - name: '@MSG_IDATA'
            offset: "00000014"            
      - num: "3"
        name: "_IGROUP"
        offset: "00003010"
        symbols:
          - name: 'VKD_Wait_Busy'
            offset: "00000000"            
          - name: 'VKD_Wait_Empty'
            offset: "0000000C"            
          - name: 'VKD_Sys_Critical_Init'
            offset: "00000018"            
          - name: 'VKD_Device_Init'
            offset: "000001E2"            
          - name: 'VKD_Init_Complete'
            offset: "000003CA"            
          - name: 'Force_Upper_Case'
            offset: "00000428"            
          - name: 'VKD_skip_white_space'
            offset: "00000433"            
          - name: 'VKD_process_cmd_ini'
            offset: "00000440"            
          - name: 'VKD_IO_Init'
            offset: "0000052A"            
          - name: 'VAD_Device_Init'
            offset: "000005F8"            
          - name: 'Kbd_Boost_Time'
            offset: "00000A6C"            
          - name: 'Kbd_Alt_Delay'
            offset: "00000A79"            
          - name: 'Kbd_Paste_TimeOut'
            offset: "00000A85"            
          - name: 'Kbd_Paste_Pause_Ini'
            offset: "00000A95"            
          - name: 'Kbd_CR_Paste_Pause_Ini'
            offset: "00000AA7"            
          - name: 'Kbd_SlowPaste_Delay'
            offset: "00000ABB"            
          - name: 'Kbd_AltPaste_Delay'
            offset: "00000AC9"            
          - name: 'Kbd_PasteBuf_Delay'
            offset: "00000AD7"            
          - name: 'Kbd_MCA_Passwd_Ini'
            offset: "00000AE6"            
          - name: 'Kbd_8042_ReadCmd_Ini'
            offset: "00000AF1"            
          - name: 'Kbd_8042_WriteCmd_Ini'
            offset: "00000AFD"            
          - name: 'Kbd_Reboot_Ini'
            offset: "00000B0A"            
          - name: 'Key_Delay_Ini'
            offset: "00000B15"            
      - num: "4"
        name: "_PTEXT"
        offset: "00003C60"
        symbols:
          - name: 'VKD_Disable_Keyboard'
            offset: "00000006"            
          - name: 'VKD_Enable_Keyboard'
            offset: "00000050"            
          - name: 'VKD_Int_15h'
            offset: "00000086"            
          - name: 'VKD_Set_Focus'
            offset: "0000011B"            
          - name: 'VKD_Get_Version'
            offset: "000001A5"            
          - name: 'VKD_Define_Hot_Key'
            offset: "000001BA"            
          - name: 'VKD_Remove_Hot_Key'
            offset: "00000287"            
          - name: 'VKD_Local_Enable_Hot_Key'
            offset: "000002EC"            
          - name: 'VKD_Local_Disable_Hot_Key'
            offset: "0000033E"            
          - name: 'VKD_Reflect_Hot_Key'
            offset: "00000390"            
          - name: 'VKD_Cancel_Hot_Key_State'
            offset: "00000419"            
          - name: 'QueueFromPasteBuf'
            offset: "00000451"            
          - name: 'VKD_Paste_Restart'
            offset: "0000056B"            
          - name: 'VKD_Alt_Timeout'
            offset: "0000057D"            
          - name: 'VKD_Int_16'
            offset: "00000590"            
          - name: 'VKD_Nudge_Int16h_Hook'
            offset: "000005CE"            
          - name: 'I16_Paste'
            offset: "000005EA"            
          - name: 'VKD_INT16_write'
            offset: "0000068F"            
          - name: 'Hot_Key_Activate_Monitor'
            offset: "000006DC"            
          - name: 'Hot_Key_Entered'
            offset: "000006FF"            
          - name: 'Hot_Key_Notify'
            offset: "000007CD"            
          - name: 'Hot_Key_Ended'
            offset: "00000872"            
          - name: 'VKD_PriorityNotify'
            offset: "00000927"            
          - name: 'VKD_Enable_Kbd'
            offset: "000009B4"            
          - name: 'VKD_Disable_Kbd'
            offset: "000009C6"            
      - num: "6"
        name: "_LOCKABLE"
        offset: "00003E00"
        symbols:
          - name: 'VKD_Sys_VM_Terminate'
            offset: "00000000"            
          - name: 'VKD_System_Exit'
            offset: "00000016"            
          - name: 'VKD_Sys_Crit_Exit'
            offset: "00000063"            
          - name: 'VAD_System_Exit'
            offset: "00000074"            
      - num: "7"
        name: "_RARE"
        offset: "00004500"
        symbols:
          - name: 'VKD_Define_Paste_Mode'
            offset: "00000006"            
          - name: 'paste_alloc_failed'
            offset: "00000032"            
          - name: 'VKD_Start_Paste'
            offset: "00000044"            
          - name: 'VKD_Cancel_Paste'
            offset: "0000010D"            
          - name: 'VKD_Abort_INT16_Paste'
            offset: "0000011E"            
          - name: 'VKD_Trap_CommandR_Reboot'
            offset: "00000148"            
          - name: 'VAD_Set_Focus'
            offset: "00000170"            
          - name: 'VAD_PM_Int_15_Emulation'
            offset: "000001B1"            
          - name: 'VAD_Int_15_Emulation'
            offset: "000001DC"            
          - name: 'VAD_Test_Data_Avail'
            offset: "0000030C"            
          - name: 'VAD_Request_Int'
            offset: "00000364"            
          - name: 'VAD_INT'
            offset: "000003A8"            
          - name: 'VAD_IRET'
            offset: "0000046C"            
          - name: 'VAD_BIOS_Far_Call'
            offset: "00000494"            
      - num: "8"
        name: "_VMCREATE"
        offset: "00004730"
        symbols:
          - name: 'VKD_Set_VM_SysIni_Defaults'
            offset: "00000000"            
          - name: 'VKD_VM_Critical_Init'
            offset: "00000034"            
          - name: 'VKD_VM_Init'
            offset: "00000093"            
          - name: 'VKD_Notify_Property_Change'
            offset: "000000B3"            
          - name: 'VAD_Create_VM'
            offset: "00000110"            
      - num: "9"
        name: "_VMDESTROY"
        offset: "00004900"
        symbols:
          - name: 'VKD_VM_Not_Executeable'
            offset: "00000000"            
          - name: 'VKD_Destroy_VM'
            offset: "00000013"            
          - name: 'VKD_End_Paste'
            offset: "0000004D"            
          - name: 'VAD_Destroy_VM'
            offset: "000000A8"            
      - num: "10"
        name: "_THCREATE"
        offset: "00004970"
        symbols:
          - name: 'VKD_VM_Suspend'
            offset: "00000000"            
      - num: "11"
        name: "_DOSVM"
        offset: "00000000"
        symbols:
          - name: 'VKD_PM_API_Entry'
            offset: "00000000"            
          - name: 'VKD_API_Get_Version'
            offset: "00000028"            
          - name: 'VKD_API_Force_Key'
            offset: "0000003C"            
