filename: "cmbatt.sys"
#TODO: bring up more details from symdeb
binary: "cmbatt.sys"
description: ""
note: ""
appearances:
  - version: "system"
    tree: []
    segments:
      - num: "1"
        name: ".text"
        offset: "00000EB0"
        symbols:
          - name: '_CmBattIoCompletion@12'
            offset: "00000000"            
          - name: '_CmBattSynchronousRequest@12'
            offset: "00000040"            
          - name: '_CmBattAddDevice@8'
            offset: "000000A0"            
          - name: '_CmBattAddBattery@8'
            offset: "00000260"            
          - name: '_CmBattAddAcAdapter@8'
            offset: "000004B0"            
          - name: '_CmBattGetAcpiInterfaces@4'
            offset: "000006D0"            
          - name: '_CmBattCreateFdo@12'
            offset: "00000850"            
          - name: '_CmBattPnpDispatch@8'
            offset: "00000A50"            
          - name: '_CmBattPowerDispatch@8'
            offset: "00000DF0"            
          - name: '_CmBattForwardRequest@8'
            offset: "00000F90"            
          - name: '_CmBattStartDevice@8'
            offset: "00001000"            
          - name: '_CmBattStopDevice@8'
            offset: "00001220"            
          - name: '_CmBattVerifyStaticInfo@8'
            offset: "000013B0"            
          - name: '_CmBattGetPsrData@8'
            offset: "00001610"            
          - name: '_CmBattGetBifData@8'
            offset: "00001720"            
          - name: '_CmBattGetBstData@8'
            offset: "00001C80"            
          - name: '_GetDwordElement@8'
            offset: "00001EF0"            
          - name: '_GetStringElement@8'
            offset: "00001F40"            
          - name: '_CmBattNotifyHandler@8'
            offset: "00001FF0"            
          - name: '_CmBattPowerNotifyHandler@8'
            offset: "000021D0"            
          - name: '_CmBattNotifyVPOWERDOfPowerChange@4'
            offset: "00002240"            
          - name: '_BatteryClassInitializeDevice@8'
            offset: "00002276"            
          - name: '_BatteryClassUnload@4'
            offset: "0000227C"            
          - name: '_BatteryClassIoctl@8'
            offset: "00002282"            
          - name: '_BatteryClassStatusNotify@4'
            offset: "00002288"            
          - name: '_KeSetEvent@12'
            offset: "0000228E"            
          - name: '_DbgPrint'
            offset: "00002294"            
          - name: '_RtlAssert@16'
            offset: "0000229A"            
          - name: '_RtlCompareUnicodeString@12'
            offset: "000022A0"            
          - name: '_RtlInitUnicodeString@8'
            offset: "000022A6"            
          - name: '_IoAttachDeviceToDeviceStack@8'
            offset: "000022AC"            
          - name: '_ExFreePool@4'
            offset: "000022B2"            
          - name: '_IoCreateDevice@28'
            offset: "000022B8"            
          - name: '_RtlAppendUnicodeToString@8'
            offset: "000022BE"            
          - name: '_ExAllocatePoolWithTag@12'
            offset: "000022C4"            
          - name: '_IoFreeIrp@4'
            offset: "000022CA"            
          - name: '@IofCallDriver@8'
            offset: "000022D0"            
          - name: '_IoAllocateIrp@8'
            offset: "000022D6"            
          - name: '_IoGetAttachedDeviceReference@4'
            offset: "000022DC"            
          - name: '_RtlIntegerToUnicodeString@12'
            offset: "000022E2"            
          - name: '@IofCompleteRequest@8'
            offset: "000022E8"            
          - name: '_PoCallDriver@8'
            offset: "000022EE"            
          - name: '_PoStartNextPowerIrp@4'
            offset: "000022F4"            
          - name: '_KeWaitForSingleObject@20'
            offset: "000022FA"            
          - name: '_KeInitializeEvent@12'
            offset: "00002300"            
          - name: '_IoDeleteDevice@4'
            offset: "00002306"            
          - name: '_RtlAppendUnicodeStringToString@8'
            offset: "0000230C"            
          - name: '_RtlAnsiStringToUnicodeString@12'
            offset: "00002312"            
          - name: '_RtlInitAnsiString@8'
            offset: "00002318"            
          - name: '_KeGetCurrentThread@0'
            offset: "0000231E"            
          - name: '_IoBuildDeviceIoControlRequest@36'
            offset: "00002324"            
          - name: '_IoGetDeviceProperty@20'
            offset: "0000232A"            
          - name: '_KeGetCurrentIrql@0'
            offset: "00002330"            
      - num: "2"
        name: ".rdata"
        offset: "000010E0"
        symbols:
          - name: '_GUID_HWPROFILE_QUERY_CHANGE'
            offset: "00000058"            
          - name: '_GUID_HWPROFILE_CHANGE_CANCELLED'
            offset: "00000068"            
          - name: '_GUID_HWPROFILE_CHANGE_COMPLETE'
            offset: "00000078"            
          - name: '_GUID_DEVICE_INTERFACE_ARRIVAL'
            offset: "00000088"            
          - name: '_GUID_DEVICE_INTERFACE_REMOVAL'
            offset: "00000098"            
          - name: '_GUID_TARGET_DEVICE_QUERY_REMOVE'
            offset: "000000A8"            
          - name: '_GUID_TARGET_DEVICE_REMOVE_CANCELLED'
            offset: "000000B8"            
          - name: '_GUID_TARGET_DEVICE_REMOVE_COMPLETE'
            offset: "000000C8"            
          - name: '_GUID_BUS_INTERFACE_STANDARD'
            offset: "000000D8"            
          - name: '_GUID_PCI_BUS_INTERFACE_STANDARD'
            offset: "000000E8"            
          - name: '_GUID_ARBITER_INTERFACE_STANDARD'
            offset: "000000F8"            
          - name: '_GUID_TRANSLATOR_INTERFACE_STANDARD'
            offset: "00000108"            
          - name: '_GUID_ACPI_INTERFACE_STANDARD'
            offset: "00000118"            
          - name: '_GUID_BUS_TYPE_PCMCIA'
            offset: "00000128"            
          - name: '_GUID_BUS_TYPE_PCI'
            offset: "00000138"            
      - num: "3"
        name: ".data"
        offset: "000011B0"
        symbols:
          - name: '_HidCmBattery'
            offset: "00000000"            
          - name: '_HidAcAdapter'
            offset: "00000004"            
          - name: '_CmBattDeviceName'
            offset: "00000008"            
          - name: '_AcAdapterName'
            offset: "0000000C"            
          - name: '_CmBattDebug'
            offset: "00000CFC"            
          - name: '_CmBattPrevPowerSource'
            offset: "00000D00"            
          - name: '_LowerPdo'
            offset: "000021B8"            
          - name: '_AcAdapterPdo'
            offset: "000021BC"            
          - name: '_AcpiInterfaces'
            offset: "000021D0"            
      - num: "4"
        name: ".idata$2"
        offset: "00001700"
        symbols:
          - name: '__IMPORT_DESCRIPTOR_BATTC'
            offset: "00000000"            
          - name: '__IMPORT_DESCRIPTOR_ntoskrnl'
            offset: "00000014"            
          - name: '__IMPORT_DESCRIPTOR_NTPNP'
            offset: "00000028"            
          - name: '__IMPORT_DESCRIPTOR_HAL'
            offset: "0000003C"            
          - name: '__NULL_IMPORT_DESCRIPTOR'
            offset: "00000050"            
          - name: '__imp__BatteryClassUnload@4'
            offset: "000000F4"            
          - name: '__imp__BatteryClassIoctl@8'
            offset: "000000F8"            
          - name: '__imp__BatteryClassStatusNotify@4'
            offset: "000000FC"            
          - name: '__imp__BatteryClassInitializeDevice@8'
            offset: "00000100"            
          - name: '\177BATTC_NULL_THUNK_DATA'
            offset: "00000104"            
          - name: '__imp__KeGetCurrentIrql@0'
            offset: "00000108"            
          - name: '\177HAL_NULL_THUNK_DATA'
            offset: "0000010C"            
          - name: '__imp__IoGetDeviceProperty@20'
            offset: "00000110"            
          - name: '\177NTPNP_NULL_THUNK_DATA'
            offset: "00000114"            
          - name: '__imp__IoAttachDeviceToDeviceStack@8'
            offset: "00000118"            
          - name: '__imp__ExFreePool@4'
            offset: "0000011C"            
          - name: '__imp__IoCreateDevice@28'
            offset: "00000120"            
          - name: '__imp__RtlInitUnicodeString@8'
            offset: "00000124"            
          - name: '__imp__RtlAppendUnicodeToString@8'
            offset: "00000128"            
          - name: '__imp__ExAllocatePoolWithTag@12'
            offset: "0000012C"            
          - name: '__imp__IoFreeIrp@4'
            offset: "00000130"            
          - name: '__imp_@IofCallDriver@8'
            offset: "00000134"            
          - name: '__imp__RtlAssert@16'
            offset: "00000138"            
          - name: '__imp__KeSetEvent@12'
            offset: "0000013C"            
          - name: '__imp__DbgPrint'
            offset: "00000140"            
          - name: '__imp__RtlCompareUnicodeString@12'
            offset: "00000144"            
          - name: '__imp__PoCallDriver@8'
            offset: "00000148"            
          - name: '__imp__PoStartNextPowerIrp@4'
            offset: "0000014C"            
          - name: '__imp__KeWaitForSingleObject@20'
            offset: "00000150"            
          - name: '__imp__KeInitializeEvent@12'
            offset: "00000154"            
          - name: '__imp__IoDeleteDevice@4'
            offset: "00000158"            
          - name: '__imp__RtlAppendUnicodeStringToString@8'
            offset: "0000015C"            
          - name: '__imp__RtlAnsiStringToUnicodeString@12'
            offset: "00000160"            
          - name: '__imp__RtlInitAnsiString@8'
            offset: "00000164"            
          - name: '__imp__KeGetCurrentThread@0'
            offset: "00000168"            
          - name: '__imp__IoBuildDeviceIoControlRequest@36'
            offset: "0000016C"            
          - name: '__imp__RtlIntegerToUnicodeString@12'
            offset: "00000170"            
          - name: '__imp_@IofCompleteRequest@8'
            offset: "00000174"            
          - name: '__imp__IoAllocateIrp@8'
            offset: "00000178"            
          - name: '__imp__IoGetAttachedDeviceReference@4'
            offset: "0000017C"            
          - name: '\177ntoskrnl_NULL_THUNK_DATA'
            offset: "00000180"            
      - num: "5"
        name: "PAGE"
        offset: "00001DD0"
        symbols:
          - name: '_CmBattUnload@4'
            offset: "00000000"            
          - name: '_CmBattOpenClose@8'
            offset: "000000D0"            
          - name: '_CmBattIoctl@8'
            offset: "00000160"            
          - name: '_CmBattQueryTag@8'
            offset: "00000210"            
          - name: '_CmBattQueryInformation@28'
            offset: "00000370"            
          - name: '_CmBattQueryStatus@12'
            offset: "000007C0"            
          - name: '_CmBattSetStatusNotify@12'
            offset: "000008A0"            
          - name: '_CmBattDisableStatusNotify@4'
            offset: "00000B80"            
          - name: '_CmBattGetApiBatteryInfo@4'
            offset: "00000C10"            
          - name: '_CmBattGetBatteryStatus@8'
            offset: "00000D60"            
          - name: '_CmBattSendDownStreamIrp@24'
            offset: "000010C0"            
          - name: '_CmBattGetUniqueId@8'
            offset: "00001220"            
          - name: '_CmBattGetStaData@8'
            offset: "00001330"            
          - name: '_CmBattSetTripPpoint@8'
            offset: "00001440"            
      - num: "6"
        name: "INIT"
        offset: "00000000"
        symbols:
          - name: '_DriverEntry@8'
            offset: "00000000"            
